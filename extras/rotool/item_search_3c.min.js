$(function(){(()=>{function t(t){return t?t+="&costume=1":t="costume=1",t}function e(t,e,n){return n[0].value&&(t?t+="&"+e+"="+n[0].value:t=e+"="+n[0].value),t}function n(n,a=!1){if(13!==n.keyCode&&1==a)return;let i=document.getElementById("item_list_output"),r=document.getElementById("costume_list_output");var l=document.getElementsByClassName("item_name"),d="";d=e(d,"item_name",l),d=t(d),d&&$.ajax({type:"GET",url:"/item/prediction_conversion_search_name/?"+d,dataType:"json",cache:!1}).done(function(t){var e="";if("none"==t)return e+='<li class="alert_msg">ご指定のキーワードではアイテムが見つかりませんでした。</li>',i.innerHTML=e,void(0==$(r).children().length&&(r.innerHTML=e));for(var n=0;n<t.length;n++)t[n].item_name.startsWith("[衣装]")?$(r).append('<li class="search_result"><span class="icon-item"><img src="/images/item_icon/'+t[n].item_icon+'.png"></span><a href="'+t[n].item_id+"/"+t[n].make_flag+'/" class="history-link" data-id="'+t[n].item_id+'" data-name="'+t[n].item_name+'" data-make_flag="'+t[n].make_flag+'" data-icon="'+t[n].item_icon+'" >'+t[n].item_name+"</a></li>"):e+='<li class="search_result"><span class="icon-item"><img src="/images/item_icon/'+t[n].item_icon+'.png"></span><a href="'+t[n].item_id+"/"+t[n].make_flag+'/" class="history-link" data-id="'+t[n].item_id+'" data-name="'+t[n].item_name+'" data-make_flag="'+t[n].make_flag+'" data-icon="'+t[n].item_icon+'" >'+t[n].item_name+"</a></li>";i.innerHTML=e||'<li class="alert_msg">ご指定のキーワードではアイテムが見つかりませんでした。</li>',0==$(r).children().length&&(r.innerHTML='<li class="alert_msg">ご指定のキーワードでは衣装アイテムが見つかりませんでした。</li>')}).fail(function(t,e,n){var a='<p class="alert_msg">通信に失敗しました。時間をおいてお試しください。</p>';i.innerHTML=a,r.innerHTML=a})}function a(n,a=!1){if(13!==n.keyCode&&1==a)return;let i=document.getElementsByClassName("item_description"),r=document.getElementById("item_list_output2"),l=document.getElementById("costume_list_output");var d="";d=e(d,"item_description",i),d&&(d=d.replace("%","-パーセント-"),d=d.replace("％","-パーセント-"),d=d.replace("+","-プラス-"),d=d.replace("＋","-プラス-"),d=d.replace("[","［"),d=d.replace("]","］")),d=t(d),d&&$.ajax({type:"GET",url:"/item/prediction_conversion_search_description/?"+d,dataType:"json"}).done(function(t){var e="";if("none"==t)return e+='<li class="alert_msg">ご指定のキーワードではアイテムが見つかりませんでした。</li>',r.innerHTML=e,void(0==$(l).children().length&&(l.innerHTML=e));for(var n=0;n<t.length;n++)t[n].item_name.startsWith("[衣装]")?$(l).append('<li class="search_result"><span class="icon-item"><img src="/images/item_icon/'+t[n].item_icon+'.png"></span><a href="'+t[n].item_id+"/"+t[n].make_flag+'/" class="history-link" data-id="'+t[n].item_id+'" data-name="'+t[n].item_name+'" data-make_flag="'+t[n].make_flag+'" data-icon="'+t[n].item_icon+'" >'+t[n].item_name+"</a></li>"):e+='<li class="search_result"><span class="icon-item"><img src="/images/item_icon/'+t[n].item_icon+'.png"></span><a href="'+t[n].item_id+"/"+t[n].make_flag+'/" class="history-link" data-id="'+t[n].item_id+'" data-name="'+t[n].item_name+'" data-make_flag="'+t[n].make_flag+'" data-icon="'+t[n].item_icon+'" >'+t[n].item_name+"</a> "+t[n].description_search+"</li>";r.innerHTML=e||'<li class="alert_msg">ご指定のキーワードでは通常アイテムが見つかりませんでした。</li>',0==$(l).children().length&&(l.innerHTML='<li class="alert_msg">ご指定のキーワードでは衣装アイテムが見つかりませんでした。</li>')}).fail(function(t,e,n){var a='<p class="alert_msg">通信に失敗しました。時間をおいてお試しください。</p>';r.innerHTML=a,l.innerHTML=a})}function i(){try{const t=localStorage.getItem(p);if(t){const e=JSON.parse(t);if(Array.isArray(e))return e}}catch(t){}return[]}function r(){let t=document.getElementById("favorite-list");const e=i();var n="";e.forEach(t=>{t&&t.item_name&&(n+='<li><span class="icon-item"><img src="/images/item_icon/'+t.item_icon+'.png"></span><a href="'+t.item_id+"/"+t.make_flag+'/" class="history-link" data-id="'+t.item_id+'" data-name="'+t.item_name+'" data-make_flag="'+t.make_flag+'" data-icon="'+t.item_icon+'" >'+t.item_name+"</a></li>")}),t.innerHTML=n}function l(t){const e=i();return e.some(e=>e.item_name===t)}function d(t,e=!0){if(t&&t.item_name)try{let n=i();n=n.filter(e=>e.item_name!==t.item_name),e&&n.push(t),localStorage.setItem(p,JSON.stringify(n))}catch(t){console.error("お気に入りの保存に失敗しました。",t)}}if($("#center_content").length>0)return;$(".site-logo").parent().html(function(t,e){return e.replace("公式ツール","公式ツール [非公式拡張 v1.1.2]")}),$("main").hide();const s="\n    <link rel=\"stylesheet\" href=\"https://code.jquery.com/ui/1.14.1/themes/base/jquery-ui.css\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\n    <style>\n        :root {\n            --sidebar-width: 450px;\n            --header-height: 60px;\n            --footer-height: 85px;\n        }\n        .app {\n            display: flex;\n            flex-direction: column;\n            background: #f7f8fa;\n            height: calc(100vh - var(--footer-height, 85px) - var(--header-height, 60px));\n        }\n\n        .titlebar-side {\n            display: flex;\n            align-items: center;\n            min-width: 48px;\n        }\n\n        .titlebar-side.right {\n            justify-content: flex-end;\n        }\n\n        .titlebar-title {\n            font-weight: 600;\n            letter-spacing: 0.2px;\n            flex: 1;\n            /* text-align: center; */\n        }\n\n        .title-btn {\n            width: 32px;\n            height: 32px;\n            padding: 0;\n            border-radius: 0;\n            border: none;\n            background: transparent;\n            box-shadow: none;\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            cursor: pointer;\n            transition: transform 0.2s ease, box-shadow 0.2s ease;\n            font-size: 14px;\n            color: #374151;\n        }\n\n        .title-btn:hover {\n            transform: translateY(-1px);\n        }\n\n        .title-btn:active {\n            transform: translateY(0);\n        }\n\n        .title-btn:focus-visible {\n            outline: 2px solid #6366f1;\n            outline-offset: 2px;\n        }\n\n        .container {\n            display: flex;\n            flex: 1;\n            overflow: hidden;\n        }\n\n        .sidebar {\n            width: var(--sidebar-width, 450px);\n            flex: 0 0 var(--sidebar-width, 450px);\n            position: relative;\n            overflow-y: auto;\n        }\n\n        .sidebar-content {\n            padding: 24px;\n            transition: opacity 0.2s ease;\n        }\n\n        .title-btn .icon {\n            font-size: 18px;\n            line-height: 1;\n        }\n\n        #center_content {\n            flex: 1;\n            /* 残りの幅をすべて使う */\n            transition: all 0.3s ease;\n            padding: 24px;\n            box-shadow: inset 0 0 0 1px #e5e7eb;\n            min-width: 0;\n            overflow-y: auto;\n        }\n\n        /* 隠す時のクラス */\n        .is-hidden {\n            width: 0;\n            flex-basis: 0;\n            min-width: 0;\n            max-height: 0;\n            opacity: 0;\n            overflow: auto;\n        }\n\n        .is-hidden .sidebar-content {\n            opacity: 0;\n            pointer-events: none;\n        }\n\n        header {\n            height: var(--header-height, 60px) !important;\n        }\n\n        footer {\n            height: var(--footer-height, 85px) !important;\n        }\n    </style>\n    <script>\n        $(document).ready(function () {\n            function applySettings() {\n                const settings = JSON.parse(localStorage.getItem('sidebarSettings')) || {};\n                Object.entries(settings).forEach(([key, value]) => {\n                    const $sidebar = $(\"#\" + key.replace(\"_hidden\", \"\"));\n                    if (value) {\n                        $sidebar.addClass('is-hidden');\n                    } else {\n                        $sidebar.removeClass('is-hidden');\n                    }\n                });\n            }\n            applySettings();\n\n            function updateSidebarSettings($sidebar) {\n                const settings = JSON.parse(localStorage.getItem('sidebarSettings')) || {};\n                settings[$sidebar.attr('id')+\"_hidden\"] = $sidebar.hasClass('is-hidden');\n                localStorage.setItem('sidebarSettings', JSON.stringify(settings));\n            }\n            \n            function updateButton($sidebar, side, $btn) {\n                const isHidden = $sidebar.hasClass('is-hidden');\n                const $icon = $btn.find('.icon');\n\n                $icon.text(isHidden ? '≡' : '✕');\n                $btn.attr('aria-label', side === 'left'\n                    ? (isHidden ? '左パネルを開く' : '左パネルを閉じる')\n                    : (isHidden ? '右パネルを開く' : '右パネルを閉じる'));\n                $btn.attr('aria-expanded', !isHidden);\n                $sidebar.attr('aria-hidden', isHidden);\n            }\n\n            function toggleSidebar($sidebar, side, $btn) {\n                $sidebar.toggleClass('is-hidden');\n                updateButton($sidebar, side, $btn);\n                updateSidebarSettings($sidebar);\n            }\n\n            const $leftSidebar = $('#leftSidebar');\n            const $rightSidebar = $('#rightSidebar');\n            const $leftBtn = $('#toggleLeft');\n            const $rightBtn = $('#toggleRight');\n\n            $leftBtn.click(function () {\n                toggleSidebar($leftSidebar, 'left', $leftBtn);\n            });\n\n            $rightBtn.click(function () {\n                toggleSidebar($rightSidebar, 'right', $rightBtn);\n            });\n\n            updateButton($leftSidebar, 'left', $leftBtn);\n            updateButton($rightSidebar, 'right', $rightBtn);\n        });\n    </script>\n<script>\n//パラメーターを作る関数\nfunction make_prameter(param,param_name,param_array){\n    for ( i = 0; i < param_array.length; i++) {\n        if ( param_array[i].checked === true ) {\n            if(param){\n                param += \"&\" + param_name + \"[]=\" + param_array[i].value;\n            }else{\n                param = \"\" + param_name + \"[]=\" + param_array[i].value;\n            }\n        }\n    }\n    return param;\n}\n//パラメータがある場合に取引履歴を上書きする関数\nfunction over_wrrite_trade_log(trade_log,param){\n\n\n    //アイテムグレードの設定の宣言\n                        var Item_Grade_Level = {};\n            Item_Grade_Level[0] = 'なし';\n                                Item_Grade_Level[1] = '★1';\n                                Item_Grade_Level[2] = '★2';\n                                Item_Grade_Level[3] = '★3';\n                                Item_Grade_Level[4] = '★4';\n            \n    \n    //パラメーターが選択されいた場合\n    if(param){\n        // Ajaxリクエスト\n        $.ajax({\n        type: \"GET\",\n        url: \"/item_trade_log_filtered_search/?\" + param,\n        dataType : \"json\",\n        cahe:false\n        })\n        // Ajaxリクエストが成功した場合\n        .done(function(data){\n            var html = \"\";\n            if(data == \"none\" ){\n                html = '<p class=\"alert_msg\">露店取引情報が見つかりません。</p>';\n                trade_log.innerHTML = html\n                return;\n            }\n            //アイテムが見つかった場合の処理\n            //通常価格\n            html += '<div id=\"Normal_Coefficient\" class=\"status-table\">';\n            html += '<table>';\n            html += '<thead><tr><th>取引実績</th><th>価格(単価)</th><th>個数</th><th>日時</th><th>MAP</th></tr></thead>';\n            for(var i=0; i<data.length; i++){\n                html += '<tr><td>';\n                if(data[i].GradeLevel>0){ html += '<div>超越段階　' + Item_Grade_Level[data[i].GradeLevel] + '</div>'; }\n                if(data[i].refining_level>0){ html += '<div> + ' + data[i].refining_level + '　' + data[i].item_name + '</div>'; }\n                else{ html += '<div>' + data[i].item_name + '</div>'; }\n                if(data[i].card1){ html += '<div>' + data[i].card1 + '</div>'; }\n                if(data[i].card2){ html += '<div>' + data[i].card2 + '</div>'; }\n                if(data[i].card3){ html += '<div>' + data[i].card3 + '</div>'; }\n                if(data[i].card4){ html += '<div>' + data[i].card4 + '</div>'; }\n                if(data[i].RandOption1){ html += '<div>' + data[i].RandOption1 + '</div>'; }\n                if(data[i].RandOption2){ html += '<div>' + data[i].RandOption2 + '</div>'; }\n                if(data[i].RandOption3){ html += '<div>' + data[i].RandOption3 + '</div>'; }\n                if(data[i].RandOption4){ html += '<div>' + data[i].RandOption4 + '</div>'; }\n                if(data[i].RandOption5){ html += '<div>' + data[i].RandOption5 + '</div>'; }\n                if(data[i].attribute_stone){ html += '<div>属性石　' + data[i].attribute_stone + '</div>'; }\n                if(data[i].star_piece){ html += '<div>星のかけら　' + data[i].star_piece + '</div>'; }\n                html += '</td>';\n                html += '<td><div class=\"money\">'+ Math.ceil(data[i].price / data[i].item_count).toLocaleString() + 'zeny</div></td>';\n                html += '<td>' + data[i].item_count + '</td>';\n                html += '<td>' + data[i].log_date.substring(0,16) + '</td>';\n                html += '<td>' + data[i].mapname + '</td>';\n                html += '</tr>';\n            }\n            html += '</table>';\n            html += '</div>';\n            //Noatun価格\n            html += '<div id=\"Noatun_Coefficient\" class=\"status-table\">';\n            html += '<table>';\n            html += '<thead><tr><th>取引実績</th><th>価格(単価)</th><th>個数</th><th>日時</th><th>MAP</th></tr></thead>';\n            for(var i=0; i<data.length; i++){\n                html += '<tr><td>';\n                if(data[i].GradeLevel>0){ html += '<div>超越段階　' + Item_Grade_Level[data[i].GradeLevel] + '</div>'; }\n                if(data[i].refining_level>0){ html += '<div> + ' + data[i].refining_level + '　' + data[i].item_name + '</div>'; }\n                else{ html += '<div>' + data[i].item_name + '</div>'; }\n                if(data[i].card1){ html += '<div>' + data[i].card1 + '</div>'; }\n                if(data[i].card2){ html += '<div>' + data[i].card2 + '</div>'; }\n                if(data[i].card3){ html += '<div>' + data[i].card3 + '</div>'; }\n                if(data[i].card4){ html += '<div>' + data[i].card4 + '</div>'; }\n                if(data[i].RandOption1){ html += '<div>' + data[i].RandOption1 + '</div>'; }\n                if(data[i].RandOption2){ html += '<div>' + data[i].RandOption2 + '</div>'; }\n                if(data[i].RandOption3){ html += '<div>' + data[i].RandOption3 + '</div>'; }\n                if(data[i].RandOption4){ html += '<div>' + data[i].RandOption4 + '</div>'; }\n                if(data[i].RandOption5){ html += '<div>' + data[i].RandOption5 + '</div>'; }\n                if(data[i].attribute_stone){ html += '<div>属性石　' + data[i].attribute_stone + '</div>'; }\n                if(data[i].star_piece){ html += '<div>星のかけら　' + data[i].star_piece + '</div>'; }\n                html += '</td>';\n                //単価が0円未満の場合unavaliableを表示する\n                if(data[i].price / data[i].item_count / 1000>1){\n                    html += '<td><div class=\"money\">'+ Math.ceil(data[i].price / data[i].item_count / 1000).toLocaleString() + 'zeny</div></td>';\n                }else{\n                    html += '<td><div class=\"money\">unavaliable</div></td>';\n                }\n                html += '<td>' + data[i].item_count + '</td>';\n                html += '<td>' + data[i].log_date.substring(0,16) + '</td>';\n                html += '<td>' + data[i].mapname + '</td>';\n                html += '</tr>';\n            }\n            html += '</table>';\n            html += '</div>';\n\n            trade_log.innerHTML = html\n        })\n        // Ajaxリクエストが失敗した場合\n        .fail(function(XMLHttpRequest, textStatus, errorThrown){\n            var html = '<p class=\"alert_msg\">通信に失敗しました。時間をおいてお試しください。</p>';\n            trade_log.innerHTML = html\n        });\n    //1度でもパラメーター選択後に条件が指定されていなかった場合\n    }else{\n        html = '<p class=\"alert_msg\">条件が指定されていません。</p>';\n            trade_log.innerHTML = html\n            return;\n    }\n}\n//パラメータがある場合に取引サマリーを上書きする関数\nfunction over_wrrite_trade_log_summary(trade_log_summary,param){\n    //パラメーターが選択されいた場合\n    if(param){\n        // Ajaxリクエスト\n        $.ajax({\n        type: \"GET\",\n        url: \"/item_trade_log_summary_filtered_search/?\" + param,\n        dataType : \"json\"\n        })\n        // Ajaxリクエストが成功した場合\n        .done(function(data){\n            var html = \"\";\n            if(data == \"none\" ){\n                //UI的におかしいので何も出力させない\n                html = '';\n                trade_log_summary.innerHTML = html\n                return;\n            }\n            //アイテムが見つかった場合の処理\n            //通常価格\n            html += '<div id=\"Normal_Coefficient_Summary\" class=\"transaction-summary\">';\n            html += '<h4>取引概要</h4>';\n            html += '<div class=\"summary_price\">';\n            html += '<div class=\"median_price\">';\n            html += '<p class=\"summary_price_label\">中央値</p>';\n            html += '<p class=\"money\">'+ Math.ceil(data.median).toLocaleString() + 'zeny</p>';\n            html += '</div>';\n            html += '<div class=\"min_price\">';\n            html += '<p class=\"summary_price_label\">最低値</p>';\n            html += '<p class=\"money\">'+ Math.ceil(data.min).toLocaleString() + 'zeny</p>';\n            html += '</div>';\n            html += '<div class=\"max_price\">';\n            html += '<p class=\"summary_price_label\">最高値</p>';\n            html += '<p class=\"money\">'+ Math.ceil(data.max).toLocaleString() + 'zeny</p>';\n            html += '</div>';\n            html += '</div>';\n            html += '</div>';\n            //Noatun価格\n            html += '<div id=\"Noatun_Coefficient_Summary\" class=\"transaction-summary\">';\n            html += '<h4>取引概要(Noatun価格)</h4>';\n            html += '<div class=\"summary_price\">';\n            html += '<div class=\"median_price\">';\n            html += '<p class=\"summary_price_label\">中央値</p>';\n            //単価が0円未満の場合unavaliableを表示する\n            if(data.median / 1000>1){\n                html += '<p class=\"money\">'+ Math.ceil(data.median / 1000).toLocaleString() + 'zeny</p>';\n            }else{\n                html += '<p class=\"money\">unavaliable</p>';\n            }\n            html += '</div>';\n            html += '<div class=\"min_price\">';\n            html += '<p class=\"summary_price_label\">最低値</p>';\n            //単価が0円未満の場合unavaliableを表示する\n            if(data.min / 1000>1){\n                html += '<p class=\"money\">'+ Math.ceil(data.min / 1000).toLocaleString() + 'zeny</p>';\n            }else{\n                html += '<p class=\"money\">unavaliable</p>';\n            }\n            html += '</div>';\n            html += '<div class=\"max_price\">';\n            html += '<p class=\"summary_price_label\">最高値</p>';\n            //単価が0円未満の場合unavaliableを表示する\n            if(data.max / 1000>1){\n                html += '<p class=\"money\">'+ Math.ceil(data.max / 1000).toLocaleString() + 'zeny</p>';\n            }else{\n                html += '<p class=\"money\">unavaliable</p>';\n            }\n            html += '</div>';\n            html += '</div>';\n            html += '</div>';\n\n            trade_log_summary.innerHTML = html\n        })\n        // Ajaxリクエストが失敗した場合\n        .fail(function(XMLHttpRequest, textStatus, errorThrown){\n            var html = '<p class=\"alert_msg\">通信に失敗しました。時間をおいてお試しください。</p>';\n            trade_log_summary.innerHTML = html\n        });\n    //1度でもパラメーター選択後に条件が指定されていなかった場合\n    }else{\n        //UI的におかしいので何も出力させない\n        html = '';\n        trade_log_summary.innerHTML = html\n        return;\n    }\n}\n\n/*\n *アイテム\n*/\nfunction parameter_search(item_id,make_flag=0){\n    //出力先を代入する\n    let trade_log = document.getElementById('trade_log')\n    let trade_log_summary = document.getElementById('trade_log_summary')\n\n    //パラメーターを取得する\n    var refining_level = document.getElementsByClassName('refining_level');\n    var card_flg = document.getElementsByClassName('card_flg');\n    var grade_level = document.getElementsByClassName('grade_level');\n\n    //必ず毎回初期化する\n    if (!item_id){\n        item_id = $(\"#center_content h1.conent-ttl\").data('id');\n    }\n    if (!make_flag){\n        make_flag = $(\"#center_content h1.conent-ttl\").data('make_flag');\n    }\n    var param = \"item_id=\" + item_id + \"&make_flag=\" + make_flag;\n    //モンスターサイズのパラメター作成\n    param = make_prameter(param,'refining_level',refining_level);\n    param = make_prameter(param,'card_flg',card_flg);\n    param = make_prameter(param,'grade_level',grade_level);\n\n\n    //アイテムの取引履歴\n    over_wrrite_trade_log(trade_log,param);\n    over_wrrite_trade_log_summary(trade_log_summary,param);\n};\n</script>\n",o='\n            <div class="titlebar-side">\n                <button class="title-btn" id="toggleLeft" type="button" aria-expanded="true"\n                    aria-controls="leftSidebar">\n                    <span class="icon">✕</span>\n                </button>\n            </div>\n',c='\n            <div class="titlebar-side right">\n                <button class="title-btn" id="toggleRight" type="button" aria-expanded="false"\n                    aria-controls="rightSidebar">\n                    <span class="icon">≡</span>\n                </button>\n            </div>\n',m='\n    <div class="app">\n        <!-- <header class="titlebar">\n            <div class="titlebar-side">\n                <button class="title-btn" id="toggleLeft" type="button" aria-expanded="false"\n                    aria-controls="leftSidebar">\n                    <span class="icon">≡</span>\n                </button>\n            </div>\n            <div class="titlebar-title">非公式ツール</div>\n            <div class="titlebar-side right">\n                <button class="title-btn" id="toggleRight" type="button" aria-expanded="false"\n                    aria-controls="rightSidebar">\n                    <span class="icon">≡</span>\n                </button>\n            </div>\n        </header> -->\n        <div class="container">\n            <aside class="sidebar left-sidebar is-hidden" id="leftSidebar" aria-hidden="true">\n                <div class="sidebar-content search">\n                    <div id="search_tabs">\n                        <ul>\n                            <li><a href="#name_tab">アイテム名</a></li>\n                            <li><a href="#description_tab">アイテム説明文</a></li>\n                            <li><a href="#costume_tab">衣装</a></li>\n                        </ul>\n                        <div id="name_tab"></div>\n                        <div id="description_tab"></div>\n                        <div id="costume_tab">\n                            <div class="result-list result-list_2columns">\n                                <ul id="costume_list_output">\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </aside>\n            <main id="center_content">\n                \n            </main>\n            <aside class="sidebar right-sidebar is-hidden" id="rightSidebar" aria-hidden="true">\n                <div class="sidebar-content list">\n                    <div id="list_tabs">\n                        <ul>\n                            <li><a href="#history_tab">検索履歴</a></li>\n                            <li><a href="#featured_tab">注目アイテム</a></li>\n                            <li><a href="#favorite_tab">お気に入り</a></li>\n                        </ul>\n                        <div id="history_tab"></div>\n                        <div id="featured_tab"></div>\n                        <div id="favorite_tab">\n                            <section class="content-wrap">\n                                <h3 class="section-ttl_mini">お気に入り</h3>\n                                <div class="result-list">\n                                    <ul id="favorite-list">\n                                    </ul>\n                                </div>\n                            </section>\n                        </div>\n                    </div>\n                </div>\n            </aside>\n        </div>\n    </div>\n';$("header").css("display","flex").css("margin-bottom",0),$(".header-inner").css("flex","1").css("justify-content","center"),$("header").prepend(o).append(c),$("article").hide(),$("head").append(s),$("main").append(m),$(".two-column-container section.content-wrap").slice(0,1).appendTo("#featured_tab"),$(".two-column-container section.content-wrap").slice(0,1).appendTo("#history_tab"),$.getScript("https://code.jquery.com/ui/1.14.1/jquery-ui.min.js",()=>{$("#list_tabs").tabs(),$("#search_tabs").tabs();const t=JSON.parse(localStorage.getItem("tabSettings"))||{};$("#list_tabs").tabs("option","active",t.list_tabs||0),$("#search_tabs").tabs("option","active",t.search_tabs||0),$("#list_tabs,#search_tabs").on("tabsactivate",function(t,e){const n=JSON.parse(localStorage.getItem("tabSettings"))||{};n[$(this).attr("id")]=$(this).tabs("option","active"),localStorage.setItem("tabSettings",JSON.stringify(n))})}),$(".item_name").removeClass("item_name"),$(".item_description").removeClass("item_description"),$(".sidebar-content.search").prepend('\n<div class="search-form-box">\n<p><input name="item" class="search_box item_name item_description" id="item_name" placeholder="キーワードを入力してください。" autocomplete="off" enterkeyhint="done"></p>\n<p><input type="button" class="reset-btn" value="✕" /></p>\n</div>\n'),$(document).on("click",".reset-btn",function(){$(".search_box.item_name.item_description").val(""),$("#item_list_output").empty(),$("#item_list_output2").empty(),$("#costume_list_output").empty()}),$(document).on("keydown","#item_name",function(t){13==t.keyCode&&$("#costume_list_output").empty(),n(t,1),a(t,1)}),$("#item_list_output").parent().appendTo("#name_tab"),$("#item_list_output2").parent().appendTo("#description_tab");const _=()=>{if($("#extras_ro_card_enchant_select_box").length>0)return;const t={datasets:[{label:"",data:[]}]};let e=null;$.getScript("https://cdn.jsdelivr.net/npm/chart.js",()=>{$.getScript("https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns",()=>{$("#trade_log").before('<canvas id="trade_scatter"></canvas>'),e=new Chart(document.getElementById("trade_scatter").getContext("2d"),{type:"scatter",data:t,options:{scales:{x:{type:"time",time:{unit:"day",tooltipFormat:"yyyy-MM-dd HH:mm",displayFormats:{day:"yyyy-MM-dd"}},title:{display:!0,text:"日時"}},y:{title:{display:!0,text:"単価"}}},plugins:{legend:{display:!1}}}}),r()})});const n=["カード","アクエリアス","アリエス","ヴァルゴ","ヴァルゴの欠片","カプリコーン","キャンサー","サーペンタリウス","サジタリウス","ジェミニ","スコーピオ","タウロス","パイシーズ","リーブラ","レオ","レオの欠片","覇者の思念","魔神の幸運","魔神の集中","魔神の迅速","魔神の体力","魔神の知力","魔神の腕力"],a=()=>{const t=new Set,e=new Set,a=$("#center_content .conent-ttl").text();$("#Normal_Coefficient > table > tbody > tr:not([style*='display: none']) > td:first-child > div").each((i,r)=>{-1==$(r).text().indexOf(a)&&(n.find(t=>$(r).text().indexOf(t)>=0)?t.add($(r).text()):e.add($(r).text()))});const i=(t,e)=>(t=String(t).replace("%","").split("+"),e=String(e).replace("%","").split("+"),1==t.length||1==e.length||t[0]!=e[0]?t[0]<e[0]?-1:1:t[1]-e[1]);return[Array.from(t).sort(i),Array.from(e).sort(i)]},i=()=>{let t,e;[t,e]=a(),$("#extras_ro_card_enchant_select_box").remove(),t.length+e.length>0&&$(".card_flg:last").parent().after('<div id="extras_ro_card_enchant_select_box"><h4>フィルタ</h4></div>'),t.length>0&&($("#extras_ro_card_enchant_select_box").append('<select id="extras_ro_card_select" style="width:20em;color:#666;padding: 0.4em 1em; border-radius: 20px;border:1px solid;background:#fff"><option value="">カード指定なし</option><option value="nocard">カードなし</option></select>'),t.forEach(t=>{$("#extras_ro_card_select").append($("<option>").val(t).text(t))})),e.length>0&&($("#extras_ro_card_enchant_select_box").append('<select id="extras_ro_enchant_select" style="width:20em;color:#666;margin-left:0.5em;padding: 0.4em 1em; border-radius: 20px;border:1px solid;background:#fff"><option value="">エンチャント指定なし</option></select>'),e.forEach(t=>{$("#extras_ro_enchant_select").append($("<option>").val(t).text(t))}))},r=()=>{const t=$("#extras_ro_card_select").val()||"",a=$("#extras_ro_enchant_select").val()||"",i=[],r=[];if($("#Normal_Coefficient > table > tbody > tr").each((e,l)=>{let d="nocard"==t,s=!1;if($("td:first-child > div",l).each((e,i)=>{d="nocard"==t?d&&!n.find(t=>$(i).text().indexOf(t)>=0):d||$(i).text().indexOf(t)>=0,s=s||$(i).text().indexOf(a)>=0}),d&&s){$(l).show(),$($("#Noatun_Coefficient > table > tbody > tr")[e]).show();$("td",l);i.push(parseInt($($("td",l)[1]).text().replaceAll(",","").replace("zeny","")));const t={x:"",y:0};t.y=parseInt($($("td",l)[1]).text().replaceAll(",","").replace("zeny","")),t.x=new Date($($("td",l)[3]).text().replace(" ","T")),r.push(t)}else $(l).hide(),$($("#Noatun_Coefficient > table > tbody > tr")[e]).hide()}),i.length){i.sort((t,e)=>t-e);const t=(i.length%2?i.length-1:i.length)/2;$("#Normal_Coefficient_Summary .median_price .money").text(`${i[t].toLocaleString()}zeny`),$("#Normal_Coefficient_Summary .min_price .money").text(`${i[0].toLocaleString()}zeny`),$("#Normal_Coefficient_Summary .max_price .money").text(`${i[i.length-1].toLocaleString()}zeny`),$("#Noatun_Coefficient_Summary .median_price .money").text(`${Math.ceil(i[t]/1e3).toLocaleString()}zeny`),$("#Noatun_Coefficient_Summary .min_price .money").text(`${Math.ceil(i[0]/1e3).toLocaleString()}zeny`),$("#Noatun_Coefficient_Summary .max_price .money").text(`${Math.ceil(i[i.length-1]/1e3).toLocaleString()}zeny`)}else $("#Normal_Coefficient_Summary .median_price .money").text("N/A"),$("#Normal_Coefficient_Summary .min_price .money").text("N/A"),$("#Normal_Coefficient_Summary .max_price .money").text("N/A"),$("#Noatun_Coefficient_Summary .median_price .money").text("N/A"),$("#Noatun_Coefficient_Summary .min_price .money").text("N/A"),$("#Noatun_Coefficient_Summary .max_price .money").text("N/A");e&&(e.data.datasets[0].data=r,e.update())};$(document).on("change","#extras_ro_card_select,#extras_ro_enchant_select",r);const l=()=>{0==$("#trade_log>*:first").length||$("#trade_log>*:first").data("loading")?setTimeout(l,100):(i(),r())};$(".item_filter input[type=checkbox]").click(()=>{$("#trade_log>*:first").data("loading","loading"),l()}),l()};document.addEventListener("click",t=>{const e=t.target.closest(".history-link");e&&(t.ctrlKey||t.metaKey||t.shiftKey||1!==t.button&&(saveLinkHistory(e),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),$.get(e.href,function(t){const n=$(t).find("article");$("#center_content").html(n),$.getScript("https://rotool.gungho.jp/js/itemdetial.js?ver=5.0.0",()=>{display_none("item-drop-monster-list"),display_none("item-drop-map-list"),parameter_search(e.dataset.id,e.dataset.make_flag)});const a=$("#center_content h1.conent-ttl");Object.entries(e.dataset).forEach(([t,e])=>a.data(t,e)),l(a.data("name"))?$("#center_content h1.conent-ttl").append('<i class="fav-icon fas fa-star" style="cursor:pointer; margin-left:10px; color: #f1c40f"></i>'):$("#center_content h1.conent-ttl").append('<i class="fav-icon far fa-star" style="cursor:pointer; margin-left:10px;"></i>'),_()})))},!0);const p="item_favorite";r(),$(document).on("click",".fav-icon",function(){$(this).toggleClass("fas fa-star"),$(this).toggleClass("far fa-star");const t=$("#center_content h1.conent-ttl"),e={item_name:t.data("name").replace(/</g,"＜").replace(/>/g,"＞"),item_id:t.data("id"),make_flag:t.data("make_flag"),item_icon:t.data("icon")};$(this).hasClass("fas")?(d(e,!0),$(this).css("color","#f1c40f")):(d(e,!1),$(this).css("color","#ccc")),r()}),$("main").show()})()});