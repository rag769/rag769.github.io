$(function(){(()=>{$(".card_flg:last").parent().after('<select id="extras_ro_card_enchant_select" style="color:#666;margin-left:0.5em;padding: 0.4em 1em; border-radius: 20px;"><option value=""></option></select>');let e=()=>{$("#extras_ro_card_enchant_select option").remove(),$("#extras_ro_card_enchant_select").append($("<option>").val("none").text(""));let e=$(".conent-ttl").text(),t=new Set;$("#Normal_Coefficient > table > tbody > tr > td:first-child > div").each((n,a)=>{-1==$(a).text().indexOf(e)&&t.add($(a).text())}),Array.from(t).sort((e,t)=>(e=String(e).replace("%","").split("+"),t=String(t).replace("%","").split("+"),1==e.length||1==t.length||e[0]!=t[0])?e[0]<t[0]?-1:1:e[1]-t[1]).forEach(e=>{$("#extras_ro_card_enchant_select").append($("<option>").val(e).text(e))})};$(document).on("change","#extras_ro_card_enchant_select",e=>{let t=$(e.target).val(),n=[];$("#Normal_Coefficient > table > tbody > tr").each((e,a)=>{"none"!=t&&0>$("td:first-child > div",a).text().indexOf(t)?$(a).hide():($(a).show(),$("td",a),n.push(parseInt($($("td",a)[1]).text().replaceAll(",","").replace("zeny",""))))}),$("#Noatun_Coefficient > table > tbody > tr").each((e,n)=>{"none"!=t&&0>$("td:first-child > div",n).text().indexOf(t)?$(n).hide():$(n).show()}),n.sort((e,t)=>e-t),half=(n.length%2?n.length-1:n.length)/2,$("#Normal_Coefficient_Summary .median_price .money").text(`${n[half].toLocaleString()}zeny`),$("#Normal_Coefficient_Summary .min_price .money").text(`${n[0].toLocaleString()}zeny`),$("#Normal_Coefficient_Summary .max_price .money").text(`${n[n.length-1].toLocaleString()}zeny`),$("#Noatun_Coefficient_Summary .median_price .money").text(`${Math.ceil(n[half]/1e3).toLocaleString()}zeny`),$("#Noatun_Coefficient_Summary .min_price .money").text(`${Math.ceil(n[0]/1e3).toLocaleString()}zeny`),$("#Noatun_Coefficient_Summary .max_price .money").text(`${Math.ceil(n[n.length-1]/1e3).toLocaleString()}zeny`)});let t=()=>{if($("#trade_log>*:first").data("loading")){setTimeout(t,500);return}e()};$(".item_filter input[type=checkbox]").click(()=>{$("#trade_log>*:first").data("loading","loading"),t()}),t()})()});
